version: "3.9"
services:
  langbridge-customer-worker:
    image: callumwhite/langbridge-worker:latest
    container_name: langbridge-customer-worker
    restart: unless-stopped
    environment:
      WORKER_EXECUTION_MODE: customer_runtime
      EDGE_API_BASE_URL: http://host.docker.internal:8000/api/v1
      EDGE_REGISTRATION_TOKEN: ${EDGE_REGISTRATION_TOKEN}
      WORKER_RUNTIME_NAME: customer-runtime-1
      WORKER_RUNTIME_TAGS: "semantic_query,region:customer"
      WORKER_RUNTIME_CAPABILITIES: '{"message_types":["semantic_query_request"]}'
      WORKER_POLL_INTERVAL: 2.0
      WORKER_BROKER: redis
    command: ["python", "-m", "langbridge.apps.worker.langbridge_worker.main"]
